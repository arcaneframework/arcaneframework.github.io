<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arcane: La configuration du code</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arcane
   &#160;<span id="projectnumber">3.7.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Recherche','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">La configuration du code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md____w_arcaneframework_github_io_arcaneframework_github_io_framework_arcane_doc_codeconfig"></a></p>
<h1><a class="anchor" id="arcanedoc_codeconfig_intro"></a>
Introduction</h1>
<p>La configuration du code est décrite dans un fichier externe, dont le nom est CODE.config, avec <em>CODE</em> le nom du code.</p>
<p>Ce fichier décrit l'ensemble des boucles en temps (voir <a class="el" href="../../d2/d0c/arcanedoc_timeloop.html">La boucle en temps</a>) disponibles pour le code, ainsi que leur configuration.</p>
<h1><a class="anchor" id="arcanedoc_codeconfig_struct"></a>
Structure du fichier</h1>
<p>Ce fichier de configuration de l'application est au format XML. Voici un exemple d'un tel fichier pour un module <em>MicroHydro</em> qui se trouve dans le répertoire des exemples de ARCANE (<code>samples</code>):</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">arcane-config</span> <span class="keyword">code-name</span>=<span class="stringliteral">&quot;MicroHydro&quot;</span>&gt;</div>
<div class="line"> &lt;<span class="keywordtype">time-loops</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">time-loop</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydroLoop&quot;</span>&gt;</div>
<div class="line">   &lt;<span class="keywordtype">title</span>&gt;<span class="keyword">MicroHydro</span>&lt;/<span class="keywordtype">title</span>&gt;</div>
<div class="line">   &lt;<span class="keywordtype">description</span>&gt;<span class="keyword">Boucle</span> <span class="keyword">en</span> <span class="keyword">temps</span> <span class="keyword">de</span> <span class="keyword">l</span>&#39;<span class="keyword">exemple</span> <span class="keyword">Arcane</span> <span class="keyword">MicroHydro</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line"> </div>
<div class="line">   &lt;<span class="keywordtype">modules</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro&quot;</span> <span class="keyword">need</span>=<span class="stringliteral">&quot;required&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ArcanePostProcessing&quot;</span> <span class="keyword">need</span>=<span class="stringliteral">&quot;required&quot;</span> /&gt;</div>
<div class="line">   &lt;/<span class="keywordtype">modules</span>&gt;</div>
<div class="line"> </div>
<div class="line">   &lt;<span class="keywordtype">singleton-services</span>&gt;</div>
<div class="line">   &lt;/<span class="keywordtype">singleton-services</span>&gt;</div>
<div class="line"> </div>
<div class="line">   &lt;<span class="keywordtype">entry-points</span> <span class="keyword">where</span>=<span class="stringliteral">&quot;init&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.HydroStartInit&quot;</span> /&gt;</div>
<div class="line">   &lt;/<span class="keywordtype">entry-points</span>&gt;</div>
<div class="line"> </div>
<div class="line">   &lt;<span class="keywordtype">entry-points</span> <span class="keyword">where</span>=<span class="stringliteral">&quot;compute-loop&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.ComputePressureForce&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.ComputeVelocity&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.ApplyBoundaryCondition&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.MoveNodes&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.ComputeGeometricValues&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.UpdateDensity&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.ApplyEquationOfState&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;MicroHydro.ComputeDeltaT&quot;</span> /&gt;</div>
<div class="line">   &lt;/<span class="keywordtype">entry-points</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;/<span class="keywordtype">time-loop</span>&gt;</div>
<div class="line"> &lt;/<span class="keywordtype">time-loops</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">arcane-config</span>&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md13"></a>
L'élément &lt;time-loops&gt;</h2>
<p>L'ensemble des boucles en temps est décrit dans l'élément <code>&lt;time-loops&gt;. Chaque boucle en temps est représentée par l'élément</code>&lt;time-loop&gt;<code>et identifiée par son nom (attribut </code>name`). Le fichier précédent décrit donc une seule boucle en temps nommée <em>MicroHydroLoop</em>.</p>
<p>Outre le titre et la description de la boucle, on remarque 3 éléments : <code>&lt;modules&gt;</code>, <code>&lt;singleton-services&gt;</code> et <code>&lt;entry-points&gt;</code>.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
L'élément &lt;modules&gt;</h3>
<p>Cet élément décrit l'ensemble des modules du code nécessaire à l'exécution de la boucle en temps. L'attribut <code>name</code> identifie le module par son nom et l'attribut <code>need</code> (valant <b>required</b> ou <b>optional</b>) indique si le module doit obligatoirement être présent ou non. Si le module n'est pas obligatoire et qu'il n'est pas fourni à l'exécution (absence de la bibliothèque du module), ses points d'entrée seront ignorés. Cela permet de construire des variantes d'une même boucle en temps.</p>
<h3><a class="anchor" id="autotoc_md15"></a>
L'élément &lt;singleton-services&gt;</h3>
<p>Cet élément est assez similaire à <code>&lt;modules&gt;</code> et décrit l'ensemble des services singletons du code utilisés lors de l'exécution. Un service singleton est un service pour lequel il n'existe qu'une seule instance qui est créée lors de l'initialisation du code. Un tel service peut avoir des options dans le jeu de données. La spécification des services singletons se fait comme suit:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">singleton-services</span>&gt;</div>
<div class="line"> &lt;<span class="keywordtype">service</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Toto&quot;</span> <span class="keyword">need</span>=<span class="stringliteral">&quot;required&quot;</span>&gt;</div>
<div class="line"> &lt;<span class="keywordtype">service</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Tutu&quot;</span> <span class="keyword">need</span>=<span class="stringliteral">&quot;optional&quot;</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">singleton-services</span>&gt;</div>
</div><!-- fragment --><p>Comme pour le module, il y a deux attributs <code>name</code> et <code>need</code>. Si le service est optionel et qu'il n'est pas trouvé, il ne sera pas instantié. Dans le code, il est possible de récupérer un service singleton dont on connait l'interface, via la classe ServiceBuilder.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
L'élément &lt;entry-points&gt;</h3>
<p>Cet élément contient l'attribut <code>where</code> précisant l'endroit d'appel des différents points d'entrée. Les valeurs possibles sont décrites dans le tableau ci-dessous:</p>
<table class="doxtable">
<tr>
<th>Valeur </th><th><p class="starttd">Description </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td><b>build</b>  </td><td><p class="starttd">Appel du point d'entrée à la création du module. Lors de la création du module, le maillage n'est pas encore chargé et il ne doit donc pas être utilisé. </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>init</b>  </td><td><p class="starttd">Appel du point d'entrée lors de l'initialisation du code. </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>compute-loop</b>  </td><td><p class="starttd">Appel du point d'entrée dans la boucle des itérations. </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>restore</b>  </td><td><p class="starttd">Appel du point d'entrée lors d'un retour arrière. </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>on-mesh-changed</b>  </td><td><p class="starttd">Appel du point d'entrée lors d'un changement de la structure de maillage (partitionnement, abandon de mailles...). </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><b>exit</b>  </td><td><p class="starttd">Appel du point d'entrée avant la sortie du code : fin de simulation, arrêt avant reprise... </p>
<p class="endtd"></p>
</td></tr>
</table>
<p>L'élément <code>&lt;entry-points&gt;</code> contient une liste de points d'entrée nommés <em>nom_du_module.nom_du_point_d'entrée</em>. La valeur de l'attribut <code>where</code> de chaque point d'entrée (faite dans <a class="el" href="../../d1/deb/arcanedoc_core.html#arcanedoc_module_desc">le descripteur de module</a>) doit être compatible avec celle de l'attribut <code>where</code> du bloc <code>&lt;entry-points&gt;</code>. Dans un bloc <em>init</em> ne peuvent être présent que des points d'entrée dont l'attribut <code>where</code> vaut <b>init</b>, <b>start-init</b>, <b>continue-init</b>. Pour les autres blocs (<b>compute-loop</b>, <b>restore</b>, <b>on-mesh-changed</b>, <b>exit</b>), les valeurs des 2 attributs <code>where</code> doivent être identiques. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré le Lundi 29 Août 2022 04:05:42 pour Arcane par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
