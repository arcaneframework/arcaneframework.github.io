<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.9.8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="../../logo_arcane.svg" type="image/svg+xml">
    <title>Arcane: Exemple d&#39;utilisation de fonctions C# pour le jeu de données</title>
    <link href="../../tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../../jquery.js"></script>
    <script type="text/javascript" src="../../dynsections.js"></script>
    <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
    <link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-custom.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../user_colors.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
    <script type="text/javascript" src="../../script-helper.js"></script>
    <script type="text/javascript" src="../../script-resize.js"></script>
    <script type="text/javascript" src="../../script-num-lines-code.js"></script>
    <script type="text/javascript" src="../../script-config-theme.js"></script>
    <script type="text/javascript" src="../../script-edit-config-theme.js"></script>
    <script type="text/javascript" src="../../script-alternative-theme.js"></script>
    <script type="text/javascript">
      // On demande l'activation de la personnalisation de la page.
      var no_custom_theme = false;
      DoxygenAwesomeDarkModeToggle.title = "Thème clair/sombre";
      DoxygenAwesomeDarkModeToggle.init();
      DoxygenAwesomeFragmentCopyButton.title = "Copier le code dans le presse-papier";
      DoxygenAwesomeFragmentCopyButton.init();
      DoxygenAwesomeParagraphLink.init();
      DoxygenAwesomeInteractiveToc.init();
      DoxygenAwesomeTabs.init()
      waitElemForResizeSideNav();
      setOldSize();
      //waitItemExpandCurrent();
    </script>
  </head>
  <body>
    <!--BEGIN CORNER_GITHUB-->
    <!-- https://tholman.com/github-corners/ -->
    <a href="https://github.com/arcaneframework/framework" class="github-corner" aria-label="Voir les sources sur GitHub">
      <svg width="70" height="70" viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
      </svg>
    </a>
    <!--END CORNER_GITHUB-->
      <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr id="projectrow">
                <td id="projectlogo">
                  <a href="../../index.html" title="Aller à la page principale">
                    <img alt="Logo" src="../../arcane_framework_small.webp" />
                  </a>
                </td>
              </tr>
              <tr id="projectrow">
                <td id="projectalign">
                  <div id="projectname">Arcane
                    <span id="projectnumber">&#160;v3.14.0.0</span>
                  </div>
                  <div id="projectbrief">Documentation utilisateur</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- end header part -->
<!-- Généré par Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('da/d4f/arcanedoc_sample_userfunction.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Exemple d'utilisation de fonctions C# pour le jeu de données</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Ce répertoire contient un exemple d'utilisation de fonctions C# pour le jeu de données. </p>
<p>Fichier CMakeLists.txt</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.21)</div>
<div class="line">project(UserFunction LANGUAGES C CXX)</div>
<div class="line"> </div>
<div class="line">find_package(<a class="code hl_namespace" href="../../d0/d32/namespaceArcane.html">Arcane</a> REQUIRED)</div>
<div class="line"> </div>
<div class="line">add_executable(UserFunction UserFunctionModule.cc main.cc UserFunction_axl.h)</div>
<div class="line"> </div>
<div class="line">arcane_generate_axl(UserFunction)</div>
<div class="line">arcane_add_arcane_libraries_to_target(UserFunction)</div>
<div class="line">target_include_directories(UserFunction PUBLIC . ${CMAKE_CURRENT_BINARY_DIR})</div>
<div class="line">configure_file(UserFunction.config ${CMAKE_CURRENT_BINARY_DIR} COPYONLY)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Command to compile C# file for functions</span></div>
<div class="line">add_custom_command(OUTPUT <span class="stringliteral">&quot;${CMAKE_CURRENT_BINARY_DIR}/ExternalFunctions.dll&quot;</span></div>
<div class="line">  COMMAND ${ARCANE_PREFIX_DIR}/bin/arcane_dotnet_compile <span class="stringliteral">&quot;${CMAKE_CURRENT_LIST_DIR}/ExternalFunctions.cs&quot;</span></div>
<div class="line">  DEPENDS <span class="stringliteral">&quot;${CMAKE_CURRENT_LIST_DIR}/ExternalFunctions.cs&quot;</span></div>
<div class="line">  WORKING_DIRECTORY <span class="stringliteral">&quot;${CMAKE_CURRENT_BINARY_DIR}&quot;</span>)</div>
<div class="line">add_custom_target(external_functions DEPENDS <span class="stringliteral">&quot;${CMAKE_CURRENT_BINARY_DIR}/ExternalFunctions.dll&quot;</span>)</div>
<div class="line">add_dependencies(UserFunction external_functions)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Add a test to run the sample</span></div>
<div class="line">add_test(NAME userfunction1 COMMAND ${CMAKE_CURRENT_BINARY_DIR}/UserFunction -A,UsingDotNet=1 ${CMAKE_CURRENT_LIST_DIR}/UserFunction.arc)</div>
<div class="ttc" id="anamespaceArcane_html"><div class="ttname"><a href="../../d0/d32/namespaceArcane.html">Arcane</a></div><div class="ttdoc">-*- tab-width: 2; indent-tabs-mode: nil; coding: utf-8-with-signature -*-</div><div class="ttdef"><b>Definition</b> <a href="../../de/df4/AbstractCaseDocumentVisitor_8cc_source.html#l00020">AbstractCaseDocumentVisitor.cc:20</a></div></div>
</div><!-- fragment --><p>Fichier ExternalFunctions.cs</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>System;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="../../d0/d32/namespaceArcane.html">Arcane</a>;</div>
<div class="line"><span class="keyword">using </span>Real = System.Double;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>UserFunctionSample</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">class </span>CaseFunctions</div>
<div class="line">  {</div>
<div class="line">    <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a> m_origin;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Constructor to initialize instance</span></div>
<div class="line">    <span class="keyword">public</span> CaseFunctions()</div>
<div class="line">    {</div>
<div class="line">      m_origin = <span class="keyword">new</span> <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a>(0.2,0.3,0.0);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// User Function.</span></div>
<div class="line">    <span class="keyword">public</span> <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a> NodeVelocityFunc(Real global_time,<a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a> position)</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a> delta = position - m_origin;</div>
<div class="line">      Real dx = delta.<a class="code hl_variable" href="../../d0/d3d/structArcane_1_1Real3POD.html#affa41c7059c883d6f4f29dd4e572f027">x</a>;</div>
<div class="line">      Real dy = delta.<a class="code hl_variable" href="../../d0/d3d/structArcane_1_1Real3POD.html#a2b3df161ba01f6d46c9c9158b6c41c95">y</a>;</div>
<div class="line">      Real dz = delta.<a class="code hl_variable" href="../../d0/d3d/structArcane_1_1Real3POD.html#a47536d1587ccd16c2693638cd935fa66">z</a>;</div>
<div class="line">      Real norm = 0.3 * System.Math.Sqrt(dx*dx+dy*dy+dz*dz);</div>
<div class="line">      Real vx = global_time * norm * dx;</div>
<div class="line">      Real vy = global_time * norm * dy;</div>
<div class="line">      Real vz = global_time * norm * dz;</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a>(vx,vy,vz);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassArcane_1_1Real3_html"><div class="ttname"><a href="../../d1/da6/classArcane_1_1Real3.html">Arcane::Real3</a></div><div class="ttdoc">Classe gérant un vecteur de réel de dimension 3.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dbb/Real3_8h_source.html#l00130">Real3.h:132</a></div></div>
<div class="ttc" id="astructArcane_1_1Real3POD_html_a2b3df161ba01f6d46c9c9158b6c41c95"><div class="ttname"><a href="../../d0/d3d/structArcane_1_1Real3POD.html#a2b3df161ba01f6d46c9c9158b6c41c95">Arcane::Real3POD::y</a></div><div class="ttdeci">Real y</div><div class="ttdoc">deuxième composante du triplet</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dbb/Real3_8h_source.html#l00036">Real3.h:36</a></div></div>
<div class="ttc" id="astructArcane_1_1Real3POD_html_a47536d1587ccd16c2693638cd935fa66"><div class="ttname"><a href="../../d0/d3d/structArcane_1_1Real3POD.html#a47536d1587ccd16c2693638cd935fa66">Arcane::Real3POD::z</a></div><div class="ttdeci">Real z</div><div class="ttdoc">troisième composante du triplet</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dbb/Real3_8h_source.html#l00037">Real3.h:37</a></div></div>
<div class="ttc" id="astructArcane_1_1Real3POD_html_affa41c7059c883d6f4f29dd4e572f027"><div class="ttname"><a href="../../d0/d3d/structArcane_1_1Real3POD.html#affa41c7059c883d6f4f29dd4e572f027">Arcane::Real3POD::x</a></div><div class="ttdeci">Real x</div><div class="ttdoc">première composante du triplet</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dbb/Real3_8h_source.html#l00035">Real3.h:35</a></div></div>
</div><!-- fragment --><p>Fichier main.cc</p>
<div class="fragment"><div class="line"><span class="comment">// -*- tab-width: 2; indent-tabs-mode: nil; coding: utf-8-with-signature -*-</span></div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Copyright 2000-2023 CEA (www.cea.fr) IFPEN (www.ifpenergiesnouvelles.com)</span></div>
<div class="line"><span class="comment">// See the top-level COPYRIGHT file for details.</span></div>
<div class="line"><span class="comment">// SPDX-License-Identifier: Apache-2.0</span></div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;arcane/launcher/ArcaneLauncher.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/d32/namespaceArcane.html">Arcane</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  ArcaneLauncher::init(<a class="code hl_class" href="../../d8/d5c/classArcane_1_1CommandLineArguments.html">CommandLineArguments</a>(&amp;argc,&amp;argv));</div>
<div class="line">  <span class="keyword">auto</span>&amp; app_build_info = ArcaneLauncher::applicationBuildInfo();</div>
<div class="line">  app_build_info.setCodeName(<span class="stringliteral">&quot;UserFunction&quot;</span>);</div>
<div class="line">  app_build_info.setCodeVersion(<a class="code hl_class" href="../../d5/d14/classArcane_1_1VersionInfo.html">VersionInfo</a>(1,0,0));</div>
<div class="line">  <span class="keywordflow">return</span> ArcaneLauncher::run();</div>
<div class="line">}</div>
<div class="ttc" id="aclassArcane_1_1CommandLineArguments_html"><div class="ttname"><a href="../../d8/d5c/classArcane_1_1CommandLineArguments.html">Arcane::CommandLineArguments</a></div><div class="ttdoc">Arguments de la ligne de commande.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/daa/CommandLineArguments_8h_source.html#l00048">CommandLineArguments.h:49</a></div></div>
<div class="ttc" id="aclassArcane_1_1VersionInfo_html"><div class="ttname"><a href="../../d5/d14/classArcane_1_1VersionInfo.html">Arcane::VersionInfo</a></div><div class="ttdoc">Informations sur une version.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d2f/VersionInfo_8h_source.html#l00045">VersionInfo.h:46</a></div></div>
</div><!-- fragment --><p>Fichier UserFunction.arc</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">case</span> <span class="keyword">codename</span>=<span class="stringliteral">&quot;UserFunction&quot;</span> <span class="keyword">xml:lang</span>=<span class="stringliteral">&quot;en&quot;</span> <span class="keyword">codeversion</span>=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">arcane</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">title</span>&gt;<span class="keyword">Sample</span>&lt;/<span class="keywordtype">title</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">timeloop</span>&gt;<span class="keyword">UserFunctionLoop</span>&lt;/<span class="keywordtype">timeloop</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">arcane</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">meshes</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">mesh</span>&gt;</div>
<div class="line">      <span class="comment">&lt;!-- You can use a file instead of a generator using the element</span></div>
<div class="line"><span class="comment">           &lt;filename&gt;/path/to/the/file&lt;/filename&gt; instead of &lt;generator/&gt; --&gt;</span> </div>
<div class="line">      &lt;<span class="keywordtype">generator</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Cartesian2D&quot;</span> &gt;</div>
<div class="line">        &lt;<span class="keywordtype">nb-part-x</span>&gt;1&lt;/<span class="keywordtype">nb-part-x</span>&gt; </div>
<div class="line">        &lt;<span class="keywordtype">nb-part-y</span>&gt;1&lt;/<span class="keywordtype">nb-part-y</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">origin</span>&gt;0.0 0.0&lt;/<span class="keywordtype">origin</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">x</span>&gt;&lt;<span class="keywordtype">n</span>&gt;20&lt;/<span class="keywordtype">n</span>&gt;&lt;<span class="keywordtype">length</span>&gt;2.0&lt;/<span class="keywordtype">length</span>&gt;&lt;/<span class="keywordtype">x</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">y</span>&gt;&lt;<span class="keywordtype">n</span>&gt;20&lt;/<span class="keywordtype">n</span>&gt;&lt;<span class="keywordtype">length</span>&gt;2.0&lt;/<span class="keywordtype">length</span>&gt;&lt;/<span class="keywordtype">y</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">generator</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">mesh</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">meshes</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">functions</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">external-assembly</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">assembly-name</span>&gt;<span class="keyword">ExternalFunctions.dll</span>&lt;/<span class="keywordtype">assembly-name</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">class-name</span>&gt;<span class="keyword">UserFunctionSample.CaseFunctions</span>&lt;/<span class="keywordtype">class-name</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">external-assembly</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">functions</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">arcane-post-processing</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">output-period</span>&gt;1&lt;/<span class="keywordtype">output-period</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">output</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">variable</span>&gt;<span class="keyword">NodeVelocity</span>&lt;/<span class="keywordtype">variable</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">output</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">arcane-post-processing</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">user-function</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">node-velocity</span> <span class="keyword">function</span>=<span class="stringliteral">&quot;NodeVelocityFunc&quot;</span>&gt;0.0 0.0 0.0&lt;/<span class="keywordtype">node-velocity</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">user-function</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;/<span class="keywordtype">case</span>&gt;</div>
</div><!-- fragment --><p>Fichier UserFunction.axl</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> ?&gt;</div>
<div class="line">&lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;UserFunction&quot;</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">description</span>&gt;<span class="keyword">Description</span> <span class="keyword">of</span> <span class="keyword">the</span> <span class="keyword">module</span> <span class="keyword">UserFunction</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">entry-points</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">method-name</span>=<span class="stringliteral">&quot;compute&quot;</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;Compute&quot;</span> <span class="keyword">where</span>=<span class="stringliteral">&quot;compute-loop&quot;</span> <span class="keyword">property</span>=<span class="stringliteral">&quot;none&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">entry-point</span> <span class="keyword">method-name</span>=<span class="stringliteral">&quot;startInit&quot;</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;StartInit&quot;</span> <span class="keyword">where</span>=<span class="stringliteral">&quot;start-init&quot;</span> <span class="keyword">property</span>=<span class="stringliteral">&quot;none&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">entry-points</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">options</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">simple</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;node-velocity&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;real3&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">options</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">variables</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;CellCenter&quot;</span> <span class="keyword">field-name</span>=<span class="stringliteral">&quot;cell_center&quot;</span> <span class="keyword">data-type</span>=<span class="stringliteral">&quot;real3&quot;</span> <span class="keyword">dim</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">item-kind</span>=<span class="stringliteral">&quot;cell&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;NodeVelocity&quot;</span> <span class="keyword">field-name</span>=<span class="stringliteral">&quot;node_velocity&quot;</span> <span class="keyword">data-type</span>=<span class="stringliteral">&quot;real3&quot;</span> <span class="keyword">dim</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">item-kind</span>=<span class="stringliteral">&quot;node&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">variables</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">module</span>&gt;</div>
</div><!-- fragment --><p>Fichier UserFunction.config</p>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;</div>
<div class="line"> &lt;arcane-config code-name=&quot;UserFunction&quot;&gt;</div>
<div class="line">  &lt;time-loops&gt;</div>
<div class="line">    &lt;time-loop name=&quot;UserFunctionLoop&quot;&gt;</div>
<div class="line">      &lt;title&gt;UserFunction&lt;/title&gt;</div>
<div class="line">      &lt;description&gt;Default timeloop for code UserFunction&lt;/description&gt;</div>
<div class="line"> </div>
<div class="line">      &lt;modules&gt;</div>
<div class="line">        &lt;module name=&quot;UserFunction&quot; need=&quot;required&quot; /&gt;</div>
<div class="line">        &lt;module name=&quot;ArcanePostProcessing&quot; need=&quot;required&quot; /&gt;</div>
<div class="line">      &lt;/modules&gt;</div>
<div class="line"> </div>
<div class="line">      &lt;entry-points where=&quot;init&quot;&gt;</div>
<div class="line">        &lt;entry-point name=&quot;UserFunction.StartInit&quot; /&gt;</div>
<div class="line">      &lt;/entry-points&gt;</div>
<div class="line">      &lt;entry-points where=&quot;compute-loop&quot;&gt;</div>
<div class="line">        &lt;entry-point name=&quot;UserFunction.Compute&quot; /&gt;</div>
<div class="line">      &lt;/entry-points&gt;</div>
<div class="line">    &lt;/time-loop&gt;</div>
<div class="line">  &lt;/time-loops&gt;</div>
<div class="line">&lt;/arcane-config&gt;</div>
</div><!-- fragment --><p>Fichier UserFunctionModule.cc</p>
<div class="fragment"><div class="line"><span class="comment">// -*- tab-width: 2; indent-tabs-mode: nil; coding: utf-8-with-signature -*-</span></div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Copyright 2000-2023 CEA (www.cea.fr) IFPEN (www.ifpenergiesnouvelles.com)</span></div>
<div class="line"><span class="comment">// See the top-level COPYRIGHT file for details.</span></div>
<div class="line"><span class="comment">// SPDX-License-Identifier: Apache-2.0</span></div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/* UserFunctionModule.cc                                       (C) 2000-2023 */</span></div>
<div class="line"><span class="comment">/*                                                                           */</span></div>
<div class="line"><span class="comment">/* Module d&#39;exemple pour les fonctions utilisateur.                          */</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;arcane/utils/Real3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;arcane/core/ITimeLoopMng.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;arcane/core/IMesh.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;arcane/core/ICaseFunction.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;arcane/core/IStandardFunction.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;UserFunction_axl.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/d32/namespaceArcane.html">Arcane</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! Module UserFunction.</span></div>
<div class="line"><span class="comment"></span><span class="keyword">class </span>UserFunctionModule</div>
<div class="line">: <span class="keyword">public</span> ArcaneUserFunctionObject</div>
<div class="line">{</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">explicit</span> UserFunctionModule(<span class="keyword">const</span> <a class="code hl_class" href="../../df/d86/classArcane_1_1ModuleBuildInfo.html">ModuleBuildInfo</a>&amp; mbi)</div>
<div class="line">  : ArcaneUserFunctionObject(mbi)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! Method called at each iteration</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">void</span> compute() <span class="keyword">override</span>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! Method called at the beginning of the execution</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">void</span> startInit() <span class="keyword">override</span>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! Version of the module</span></div>
<div class="line"><span class="comment"></span>  <a class="code hl_class" href="../../d5/d14/classArcane_1_1VersionInfo.html">VersionInfo</a> versionInfo()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d14/classArcane_1_1VersionInfo.html">VersionInfo</a>(1, 0, 0); }</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="../../d9/d89/classArcane_1_1IBinaryMathFunctor.html">IBinaryMathFunctor&lt;Real, Real3, Real3&gt;</a>* m_node_velocity_functor = <span class="keyword">nullptr</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> UserFunctionModule::</div>
<div class="line">compute()</div>
<div class="line">{</div>
<div class="line">  info() &lt;&lt; <span class="stringliteral">&quot;Module UserFunction COMPUTE&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Stop code after 10 iterations</span></div>
<div class="line">  <span class="keywordflow">if</span> (m_global_iteration() &gt; 10)</div>
<div class="line">    subDomain()-&gt;timeLoopMng()-&gt;stopComputeLoop(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Loop over the cells and compute the center of each cell</span></div>
<div class="line">  <a class="code hl_class" href="../../d7/d20/classArcane_1_1MeshVariableScalarRefT.html">VariableNodeReal3</a>&amp; nodes_coordinates = defaultMesh()-&gt;nodesCoordinates();</div>
<div class="line">  <a class="code hl_define" href="../../d6/d0f/ItemEnumerator_8h.html#a44837b340ff8a4fc02299e3160a4da20">ENUMERATE_</a> (<a class="code hl_class" href="../../d9/db2/classArcane_1_1Cell.html">Cell</a>, icell, allCells()) {</div>
<div class="line">    <a class="code hl_class" href="../../d9/db2/classArcane_1_1Cell.html">Cell</a> cell = *icell;</div>
<div class="line">    <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a> cell_center = Real3::zero();</div>
<div class="line">    <span class="comment">// Iteration over nodes of the cell</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_class" href="../../d8/dd7/classArcane_1_1Node.html">Node</a> node : cell.nodes()) {</div>
<div class="line">      cell_center += nodes_coordinates[node];</div>
<div class="line">    }</div>
<div class="line">    cell_center /= cell.<a class="code hl_function" href="../../d4/d55/classArcane_1_1ItemWithNodes.html#ae1c7e80b8f5f0bf7374bee7371e659c5">nbNode</a>();</div>
<div class="line">    m_cell_center[icell] = cell_center;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Compute NodeVelocity using external function</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d60/namespaceArccore.html#a186895d3c679e34cffb1ecf0db5c3aaa">Real</a> current_time = m_global_time();</div>
<div class="line">    <a class="code hl_define" href="../../d6/d0f/ItemEnumerator_8h.html#a44837b340ff8a4fc02299e3160a4da20">ENUMERATE_</a> (<a class="code hl_class" href="../../d8/dd7/classArcane_1_1Node.html">Node</a>, inode, allNodes()) {</div>
<div class="line">      <a class="code hl_class" href="../../d1/da6/classArcane_1_1Real3.html">Real3</a> position = nodes_coordinates[inode];</div>
<div class="line">      m_node_velocity[inode] = m_node_velocity_functor-&gt;apply(current_time, position);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Move nodes</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d60/namespaceArccore.html#a186895d3c679e34cffb1ecf0db5c3aaa">Real</a> current_deltat = m_global_deltat();</div>
<div class="line">    <a class="code hl_define" href="../../d6/d0f/ItemEnumerator_8h.html#a44837b340ff8a4fc02299e3160a4da20">ENUMERATE_</a> (<a class="code hl_class" href="../../d8/dd7/classArcane_1_1Node.html">Node</a>, inode, allNodes()) {</div>
<div class="line">      nodes_coordinates[inode] += m_node_velocity[inode] * current_deltat;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> UserFunctionModule::</div>
<div class="line">startInit()</div>
<div class="line">{</div>
<div class="line">  info() &lt;&lt; <span class="stringliteral">&quot;Module UserFunction INIT&quot;</span>;</div>
<div class="line">  m_global_deltat.assign(0.1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Check we have user function for node velocity</span></div>
<div class="line">  {</div>
<div class="line">    <a class="code hl_class" href="../../d6/dec/classArcane_1_1ICaseFunction.html">ICaseFunction</a>* opt_function = options()-&gt;nodeVelocity.function();</div>
<div class="line">    <a class="code hl_class" href="../../db/d86/classArcane_1_1IStandardFunction.html">IStandardFunction</a>* scf = options()-&gt;nodeVelocity.standardFunction();</div>
<div class="line">    <span class="keywordflow">if</span> (!scf)</div>
<div class="line">      <a class="code hl_define" href="../../d0/d1e/ArcaneGlobal_8h.html#a9d85d5fb84c5371348dd56600999e564">ARCANE_FATAL</a>(<span class="stringliteral">&quot;No standard case function for option &#39;node-velocity&#39;&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span>* functor = scf-&gt;getFunctorRealReal3ToReal3();</div>
<div class="line">    <span class="keywordflow">if</span> (!functor)</div>
<div class="line">      <a class="code hl_define" href="../../d0/d1e/ArcaneGlobal_8h.html#a9d85d5fb84c5371348dd56600999e564">ARCANE_FATAL</a>(<span class="stringliteral">&quot;Standard function &#39;{0}&#39; is not convertible to f(Real,Real3) -&gt; Real3&quot;</span>, opt_function-&gt;<a class="code hl_function" href="../../d6/dec/classArcane_1_1ICaseFunction.html#a8859eae7b27b83d9647030b4eabfabe8">name</a>());</div>
<div class="line">    m_node_velocity_functor = functor;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line">ARCANE_REGISTER_MODULE_USERFUNCTION(UserFunctionModule);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="ttc" id="aArcaneGlobal_8h_html_a9d85d5fb84c5371348dd56600999e564"><div class="ttname"><a href="../../d0/d1e/ArcaneGlobal_8h.html#a9d85d5fb84c5371348dd56600999e564">ARCANE_FATAL</a></div><div class="ttdeci">#define ARCANE_FATAL(...)</div><div class="ttdoc">Macro envoyant une exception FatalErrorException.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d1e/ArcaneGlobal_8h_source.html#l00809">ArcaneGlobal.h:809</a></div></div>
<div class="ttc" id="aItemEnumerator_8h_html_a44837b340ff8a4fc02299e3160a4da20"><div class="ttname"><a href="../../d6/d0f/ItemEnumerator_8h.html#a44837b340ff8a4fc02299e3160a4da20">ENUMERATE_</a></div><div class="ttdeci">#define ENUMERATE_(type, name, group)</div><div class="ttdoc">Enumérateur générique d'un groupe d'entité</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d0f/ItemEnumerator_8h_source.html#l00407">ItemEnumerator.h:407</a></div></div>
<div class="ttc" id="aclassArcane_1_1Cell_html"><div class="ttname"><a href="../../d9/db2/classArcane_1_1Cell.html">Arcane::Cell</a></div><div class="ttdoc">Maille d'un maillage.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dd4/Item_8h_source.html#l01171">Item.h:1173</a></div></div>
<div class="ttc" id="aclassArcane_1_1IBinaryMathFunctor_html"><div class="ttname"><a href="../../d9/d89/classArcane_1_1IBinaryMathFunctor.html">Arcane::IBinaryMathFunctor</a></div><div class="ttdoc">Interface d'une fonction mathématique binaire.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d5f/IMathFunctor_8h_source.html#l00030">IMathFunctor.h:31</a></div></div>
<div class="ttc" id="aclassArcane_1_1ICaseFunction_html"><div class="ttname"><a href="../../d6/dec/classArcane_1_1ICaseFunction.html">Arcane::ICaseFunction</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/d5d/ICaseFunction_8h_source.html#l00045">ICaseFunction.h:46</a></div></div>
<div class="ttc" id="aclassArcane_1_1ICaseFunction_html_a8859eae7b27b83d9647030b4eabfabe8"><div class="ttname"><a href="../../d6/dec/classArcane_1_1ICaseFunction.html#a8859eae7b27b83d9647030b4eabfabe8">Arcane::ICaseFunction::name</a></div><div class="ttdeci">virtual String name() const =0</div><div class="ttdoc">nom de la fonction</div></div>
<div class="ttc" id="aclassArcane_1_1IStandardFunction_html"><div class="ttname"><a href="../../db/d86/classArcane_1_1IStandardFunction.html">Arcane::IStandardFunction</a></div><div class="ttdoc">Interface gérant une fonction standard.</div><div class="ttdef"><b>Definition</b> <a href="../../de/da4/IStandardFunction_8h_source.html#l00041">IStandardFunction.h:42</a></div></div>
<div class="ttc" id="aclassArcane_1_1ItemWithNodes_html_ae1c7e80b8f5f0bf7374bee7371e659c5"><div class="ttname"><a href="../../d4/d55/classArcane_1_1ItemWithNodes.html#ae1c7e80b8f5f0bf7374bee7371e659c5">Arcane::ItemWithNodes::nbNode</a></div><div class="ttdeci">Int32 nbNode() const</div><div class="ttdoc">Nombre de noeuds de l'entité</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dd4/Item_8h_source.html#l00760">Item.h:760</a></div></div>
<div class="ttc" id="aclassArcane_1_1MeshVariableScalarRefT_html"><div class="ttname"><a href="../../d7/d20/classArcane_1_1MeshVariableScalarRefT.html">Arcane::MeshVariableScalarRefT&lt; Node, Real3 &gt;</a></div></div>
<div class="ttc" id="aclassArcane_1_1ModuleBuildInfo_html"><div class="ttname"><a href="../../df/d86/classArcane_1_1ModuleBuildInfo.html">Arcane::ModuleBuildInfo</a></div><div class="ttdoc">Informations pour construire un module.</div><div class="ttdef"><b>Definition</b> <a href="../../da/ddb/ModuleBuildInfo_8h_source.html#l00037">ModuleBuildInfo.h:38</a></div></div>
<div class="ttc" id="aclassArcane_1_1Node_html"><div class="ttname"><a href="../../d8/dd7/classArcane_1_1Node.html">Arcane::Node</a></div><div class="ttdoc">Noeud d'un maillage.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/ddc/Dom_8h_source.html#l00203">Dom.h:204</a></div></div>
<div class="ttc" id="anamespaceArccore_html_a186895d3c679e34cffb1ecf0db5c3aaa"><div class="ttname"><a href="../../d5/d60/namespaceArccore.html#a186895d3c679e34cffb1ecf0db5c3aaa">Arccore::Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Type représentant un réel.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d76/ArccoreGlobal_8h_source.html#l00225">ArccoreGlobal.h:225</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
  <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="navelem"><a class="el" href="../../index.html">%Arcane</a></li><li class="navelem"><a class="el" href="../../db/d53/arcanedoc_examples.html">Exemples et didacticiel</a></li><li class="navelem"><a class="el" href="../../d2/d06/arcanedoc_samples_directory.html">Répertoire d&#39;exemples</a></li>
      <li class="footer">Généré le Lundi 22 Juillet 2024 02:43:19 pour Arcane par <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
    </ul>
  </div>
  <script type="text/javascript" src="../../script-apply-config-theme.js"></script>
  <script type="text/javascript">
    // On met l'appel à cette fonction dans le footer dans le cas où
    // une page ne veut pas de personnalisation (changement de la 
    // variable globale "no_custom_theme").
    applyConfigWithCookies();
  </script>
</body>
</html>
