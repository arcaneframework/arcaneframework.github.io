<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arcane: Vue d&#39;ensemble de Arcane</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arcane
   &#160;<span id="projectnumber">3.7.7.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Recherche','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('db/d2f/arcane_overview.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Vue d'ensemble de Arcane </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table des matières</h3>
<ul><li class="level1"><a href="#arcane_overview_basicstruct">Structures et types de base</a><ul><li class="level2"><a href="#arcane_overview_basicstruct_types">Types de bases</a></li>
<li class="level2"><a href="#arcane_overview_basicstruct_meshitem">Entités du maillage</a></li>
</ul>
</li>
<li class="level1"><a href="#arcane_overview_iteration">Itération</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_common_overview"></a></p>
<p>Arcane est un environnement de développement pour les codes de calculs numériques parallèles. Il prend en charge les aspects architecturaux d'un code de calcul comme les structures de données pour le maillage, le parallélisme mais aussi des aspects plus liés à l'environnement comme la configuration du jeu de données.</p>
<p>Un code de calcul, quel qu'il soit, peut être vu comme un système prenant certaines valeurs en entrée et fournissant des valeurs en sortie en effectuant des <em>opérations</em>. Comme il est impossible de pouvoir traiter tous les types de codes de calcul, Arcane se restreint aux codes de calcul ayant les propriétés suivantes:</p>
<ul>
<li>le déroulement de l'exécution peut être décrit comme une répétition d'une suite d'opérations, chaque exécution de la suite d'opération étant appelé une <em>itération</em>;</li>
<li>Le domaine de calcul est discrétisé dans l'espace en un ensemble d'éléments, le <em>maillage</em>. Ce maillage peut être 1D, 2D ou 3D. Un maillage est constitué d'au plus quatre type d'éléments : les noeuds, les arêtes, les faces et les mailles. Les valeurs manipulées par le code reposent sur un de ces types d'éléments.</li>
</ul>
<p>Chacun des termes décrit précédemment possède une terminologie propre à Arcane:</p>
<ul>
<li>une opération du code est appelée un <a class="el" href="../../d1/deb/arcanedoc_core.html#arcanedoc_entrypoint">point d'entrée</a>. La description de la suite d'opération s'appelle la <a class="el" href="../../d2/d0c/arcanedoc_timeloop.html">boucle en temps</a></li>
<li>les valeurs manipulées sont appelées des <a class="el" href="../../d1/deb/arcanedoc_core.html#arcanedoc_variable">variables</a> Par exemple, la température, la pression sont des variables.</li>
</ul>
<p>En général, un code de calcul peut être décomposé en plusieurs parties distinctes. Par exemple, le calcul numérique proprement dit et la partie effectuant des sorties pour le dépouillement. De même, un code peut utiliser plusieurs physiques : hydrodynamique, thermique, ... Pour assurer la modularité d'un code, Arcane fournit ce qu'on appelle <a class="el" href="../../d1/deb/arcanedoc_core.html#arcanedoc_module">un module</a> qui regroupe l'ensemble des points d'entrée et variables correspondant à une partie donnée du code.</p>
<p>Enfin, les modules ont souvent besoin de capitaliser certaines fonctionnalités. Par exemple, un module thermique et un module hydrodynamique peuvent vouloir utiliser le même schéma numérique. Pour assurer la capitalisation du code, Arcane fournit ce qu'on appelle <a class="el" href="../../d1/deb/arcanedoc_core.html#arcanedoc_service">un service</a></p>
<p>Les 4 notions décrites précédemment (point d'entrée, variable, module et service) sont les notions de base de Arcane. Elles sont décrites plus en détail dans le document <a class="el" href="../../d1/deb/arcanedoc_core.html">Les types fondamentaux</a>. Néanmoins, avant de voir plus en détail le fonctionnement des ces trois objets, il faut connaître les notions de base présentées dans les chapitres de ce document.</p>
<dl class="section note"><dt>Note</dt><dd>Arcane est implémenté en utilisant le langage C++ norme 2011. Même si des fonctionnalités avancées du C++ sont utilisés en interne, les types et opérations mises à la disposition du développeur numériciens ont soigneusement été étudiées pour rester le plus simple possible.</dd></dl>
<h1><a class="anchor" id="arcane_overview_basicstruct"></a>
Structures et types de base</h1>
<h2><a class="anchor" id="arcane_overview_basicstruct_types"></a>
Types de bases</h2>
<p>Arcane fournit un ensemble de types de base, correspondant soit à un type existant du C++ (comme <em>int</em>, <em>double</em>), soit à une classe (comme Real2). Ces types sont utilisés pour toutes les opérations courantes mais aussi pour les variables. Par exemple, lorsqu'on souhaite déclarer un entier, il faut utiliser #Integer au lieu de <em>int</em> ou <em>long</em>. Cela permet de modifier la taille de ces types (par exemple, utiliser des entiers sur 8 octets au lieu de 4) sans modifier le code source.</p>
<p>Les types de bases sont:</p>
<table class="doxtable">
<tr>
<td><b>Nom de la classe</b></td><td><b>Correspondance dans les spécifications</b> </td></tr>
<tr>
<td>#Integer </td><td>entier signé  </td></tr>
<tr>
<td>#Int16 </td><td>entier signé sur 16 bits  </td></tr>
<tr>
<td>#Int32 </td><td>entier signé sur 32 bits  </td></tr>
<tr>
<td>#Int64 </td><td>entier signé sur 64 bits  </td></tr>
<tr>
<td>#Byte </td><td>représente un caractère sur 8 bits  </td></tr>
<tr>
<td>#Real </td><td>réel IEEE 754  </td></tr>
<tr>
<td>Real2 </td><td>coordonnée 2D, vecteur de deux réels  </td></tr>
<tr>
<td>Real3 </td><td>coordonnée 3D, vecteur de trois réels  </td></tr>
<tr>
<td>Real2x2 </td><td>tenseur 2D, vecteur de quatre réels  </td></tr>
<tr>
<td>Real3x3 </td><td>tenseur 3D, vecteur de neufs réels  </td></tr>
<tr>
<td>String </td><td>chaîne de caractères ISO-8859-1  </td></tr>
</table>
<p>Par défaut, les entiers (#Integer) sont stockés sur 4 octets mais il est possible de passer sur 8 octets en compilant avec la macro <b>ARCANE_64BIT</b>. Par défaut, les flottants (#Real, Real2, Real2x2, Real3, Real3x3) utilisent des réels double précision de la normae IEEE 754 et sont stockés sur 8 octets.</p>
<h2><a class="anchor" id="arcane_overview_basicstruct_meshitem"></a>
Entités du maillage</h2>
<p>Il existe 4 types d'entités de base dans un maillage : les noeuds, les arêtes, les faces et les mailles. A chacun de ces types correspond une classe C++ dans Arcane. Pour chaque type d'entité, il existe un type <em>groupe</em> qui gère un ensemble d'entités de ce type. La classe qui gère un groupe d'une entité a pour nom celui de l'entité suffixé par <em>Group</em>. Par exemple, pour les noeuds, il s'agit de #NodeGroup.</p>
<table class="doxtable">
<tr>
<td><b>Nom de la classe</b></td><td><b>Correspondance dans les spécifications</b> </td></tr>
<tr>
<td>Node </td><td>un noeud  </td></tr>
<tr>
<td>Face </td><td>une face en 3D, une arête en 2D </td></tr>
<tr>
<td>Edge </td><td>une arête en 3D </td></tr>
<tr>
<td>Cell </td><td>une maille  </td></tr>
<tr>
<td>#NodeGroup </td><td>un groupe de noeuds  </td></tr>
<tr>
<td>#EdgeGroup </td><td>un groupe d'arêtes  </td></tr>
<tr>
<td>#FaceGroup </td><td>un groupe de faces  </td></tr>
<tr>
<td>#CellGroup </td><td>un groupe de mailles  </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>En dimension 2, les faces correspondent aux arêtes et en dimension 3 aux faces. Ceci permet aux algorithmes numériques de parcourir le maillage indépendamment de sa dimension. L'entité arête (Edge) n'existe que pour les maillages 3D et correspond alors à une arête.</dd></dl>
<p>Chaque entité du maillage correspond à une instance d'une classe. Par exemple, si le maillage contient 15 mailles, il y a 15 instances du type Cell. Chaque classe fournit un certain nombre d'opérations permettant de relier les instances entre elles. Par exemple, la méthode Cell::node(Integer) de la classe <em>Cell</em> permet de récupérer le ième noeud de cette maille. De même, la méthode Cell::nbNode() permet de récupérer le nombre de noeuds de la maille. Pour plus de renseignements sur les opérations supportées, il est nécessaire de se reporter à la documentation en ligne des classes correspondantes (Node, Edge, Face, Cell).</p>
<p>Il existe d'autres types d'entités comme les particules (Particle), les liens (Link), les noeuds duaux (DualNode) ou les degrés de liberté (DoF).</p>
<h1><a class="anchor" id="arcane_overview_iteration"></a>
Itération</h1>
<p>Avant de pouvoir coder une opération, il faut bien comprendre comment s'écrit une boucle sur une liste d'entités de maillage telles que les mailles ou les noeuds. En effet, pratiquement toutes les opérations que l'on effectue se font sur un ensemble d'entités et donc comportent une boucle sur une liste d'entités. Par exemple, calculer la masse des mailles consiste à boucler sur l'ensemble des mailles et pour chacune d'elle effectuer le produit de son volume par sa densité. Conventionnellement, cela peut s'écrire de la manière suivante :</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span>( Integer i=0; i&lt;nbCell(); ++i )</div>
<div class="line">  m_cell_mass[i] = m_density[i] * m_volume[i];</div>
</div><!-- fragment --><p>La boucle <em>for</em> comprend trois parties séparées par un point-virgule. La première est l'initialisation, la seconde est le test de sortie de boucle et la troisième est l'opération effectuée entre deux itérations.</p>
<p>L'écriture précédente a plusieurs inconvénients :</p><ul>
<li>elle fait apparaître la structure de donnée sous-jacente, à savoir un tableau;</li>
<li>elle utilise un indice de type entier pour accéder aux éléments. Ce typage faible est source d'erreur car il ne permet pas, entre autre, de tenir compte du genre de la variable. Par exemple, on pourrait écrire <code>m_velocity</code>[i] avec <code>i</code> étant un numéro de maille et <code>m_velocity</code> une variable aux noeuds;</li>
<li>elle oblige à ce que la numérotation des entités soit contigue.</li>
</ul>
<p>En considérant qu'on parcourt toujours la liste des entités dans le même ordre, il est possible de modéliser le comportement précédent par quatre opérations :</p>
<ul>
<li>initialiser un compteur au début du tableau;</li>
<li>incrémenter le compteur;</li>
<li>regarder si le compteur est à la fin du tableau;</li>
<li>retourner l'élément correspondant au compteur.</li>
</ul>
<p>Le mécanisme est alors général et indépendant du type du conteneur : l'ensemble des entités pourrait être implémenté sous forme de tableau ou de liste sans changer ce formalisme. Dans l'architecture, le compteur ci-dessus est appelé un <em>itérateur</em> et itérer sur l'ensemble des éléments se fait en fournissant un itérateur de début et de fin, autrement appelé un <em>énumérateur</em></p>
<p>Dans Arcane, cet énumérateur dérive de la classe de base ItemEnumerator et possède les méthodes suivantes:</p>
<ul>
<li>un constructeur prenant en argument un groupe d'entité du maillage;</li>
<li><em>operator++()</em>: pour accèder à l'élément suivant;</li>
<li><em>hasNext()</em> : pour tester si on se trouve à la fin de l'itération;</li>
<li><em>operator*()</em>: qui retourne l'élément courant.</li>
</ul>
<p>Afin d'ajouter un niveau d'abstraction supplémentaire et de permettre d'instrumenter le code, Arcane fournit une fonction sous forme de macro pour chaque type d'énumérateur. Cette fonction possède le prototype suivant:</p>
<div class="fragment"><div class="line"><a class="code" href="../../d6/d0f/ItemEnumerator_8h.html#a44837b340ff8a4fc02299e3160a4da20">ENUMERATE_</a>[type]( nom_iterateur, nom_groupe )</div>
<div class="ttc" id="aItemEnumerator_8h_html_a44837b340ff8a4fc02299e3160a4da20"><div class="ttname"><a href="../../d6/d0f/ItemEnumerator_8h.html#a44837b340ff8a4fc02299e3160a4da20">ENUMERATE_</a></div><div class="ttdeci">#define ENUMERATE_(type, name, group)</div><div class="ttdoc">Enumérateur générique d'un groupe d'entité</div><div class="ttdef"><b>Definition:</b> ItemEnumerator.h:308</div></div>
</div><!-- fragment --><p>avec:</p><ul>
<li><b>[type]</b> le type d'élément (<code>NODE</code>, <code>CELL</code>, ...),</li>
<li><b>nom_iterateur</b> le nom de l'itérateur</li>
<li><b>nom_groupe</b> le nom du groupe sur lequel on itère.</li>
</ul>
<p>Par exemple, pour itérer sur toutes les mailles, avec <b>i</b> le nom de l'itérateur:</p>
<div class="fragment"><div class="line"><a class="code" href="../../d6/d0f/ItemEnumerator_8h.html#aaf5910d68ad8428248f844535ab071f3">ENUMERATE_CELL</a>(i,allCells())</div>
<div class="ttc" id="aItemEnumerator_8h_html_aaf5910d68ad8428248f844535ab071f3"><div class="ttname"><a href="../../d6/d0f/ItemEnumerator_8h.html#aaf5910d68ad8428248f844535ab071f3">ENUMERATE_CELL</a></div><div class="ttdeci">#define ENUMERATE_CELL(name, group)</div><div class="ttdoc">Enumérateur générique d'un groupe de mailles.</div><div class="ttdef"><b>Definition:</b> ItemEnumerator.h:328</div></div>
</div><!-- fragment --><p>La boucle de calcul de la masse décrite précédemment devient alors :</p>
<div class="fragment"><div class="line"><a class="code" href="../../d6/d0f/ItemEnumerator_8h.html#aaf5910d68ad8428248f844535ab071f3">ENUMERATE_CELL</a>(i,allCells()){</div>
<div class="line">  m_cell_mass[i] = m_density[i] * m_volume[i];</div>
<div class="line">}</div>
</div><!-- fragment --><p>Le type d'un énumérateur dépend du type d'élément de maillage : un énumérateur sur un groupe de noeuds n'est pas du même type qu'un énumérateur sur un groupe de mailles et ils sont donc incompatibles. Par exemple, si la vitesse est une variable aux noeuds, l'exemple suivant provoque une erreur de compilation:</p>
<div class="fragment"><div class="line">cout &lt;&lt; m_velocity[i]; <span class="comment">// Erreur!</span></div>
</div><!-- fragment --><p>De même, il est impossible d'écrire :</p>
<div class="fragment"><div class="line"><a class="code" href="../../d6/d0f/ItemEnumerator_8h.html#aaf5910d68ad8428248f844535ab071f3">ENUMERATE_CELL</a>(i,allNodes()) <span class="comment">// Erreur!</span></div>
</div><!-- fragment --><p>car <b>allNodes()</b> est un groupe de noeud et <b>i</b> un énumérateur sur un groupe de mailles.</p>
<p>Notons que l'opérateur '*' de l'énumérateur permet d'accéder à l'élément courant: </p><div class="fragment"><div class="line"><a class="code" href="../../d6/d0f/ItemEnumerator_8h.html#aaf5910d68ad8428248f844535ab071f3">ENUMERATE_CELL</a>(i,allCells()){</div>
<div class="line">  Cell cell = *i;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Il est possible d'utiliser l'entité elle-même pour récupérer la valeur d'une variable mais, pour des raisons de performances, il faut privilégier l'accès par l'itérateur: </p><div class="fragment"><div class="line"><a class="code" href="../../d6/d0f/ItemEnumerator_8h.html#aaf5910d68ad8428248f844535ab071f3">ENUMERATE_CELL</a>(icell,allCells()){</div>
<div class="line">  Cell cell = *i;</div>
<div class="line">  m_cell_mass[cell] = m_density[cell] * m_volume[cell]; <span class="comment">// moins performant</span></div>
<div class="line">  m_cell_mass[icell] = m_density[icell] * m_volume[icell]; <span class="comment">// plus performant</span></div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">%Arcane</a></li>
    <li class="footer">Généré le Lundi 19 Septembre 2022 04:39:37 pour Arcane par <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
