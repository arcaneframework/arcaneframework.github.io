<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.9.8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="../../logo_arcane.svg" type="image/svg+xml">
    <title>Arcane: Exemple n°4</title>
    <link href="../../tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../../jquery.js"></script>
    <script type="text/javascript" src="../../dynsections.js"></script>
    <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
    <link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-custom.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../user_colors.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
    <script type="text/javascript" src="../../script-helper.js"></script>
    <script type="text/javascript" src="../../script-resize.js"></script>
    <script type="text/javascript" src="../../script-num-lines-code.js"></script>
    <script type="text/javascript" src="../../script-config-theme.js"></script>
    <script type="text/javascript" src="../../script-edit-config-theme.js"></script>
    <script type="text/javascript" src="../../script-alternative-theme.js"></script>
    <script type="text/javascript">
      // On demande l'activation de la personnalisation de la page.
      var no_custom_theme = false;
      DoxygenAwesomeDarkModeToggle.title = "Thème clair/sombre";
      DoxygenAwesomeDarkModeToggle.init();
      DoxygenAwesomeFragmentCopyButton.title = "Copier le code dans le presse-papier";
      DoxygenAwesomeFragmentCopyButton.init();
      DoxygenAwesomeParagraphLink.init();
      DoxygenAwesomeInteractiveToc.init();
      DoxygenAwesomeTabs.init()
      waitElemForResizeSideNav();
      setOldSize();
      //waitItemExpandCurrent();
    </script>
  </head>
  <body>
    <!--BEGIN CORNER_GITHUB-->
    <!-- https://tholman.com/github-corners/ -->
    <a href="https://github.com/arcaneframework/framework" class="github-corner" aria-label="Voir les sources sur GitHub">
      <svg width="70" height="70" viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
      </svg>
    </a>
    <!--END CORNER_GITHUB-->
      <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr id="projectrow">
                <td id="projectlogo">
                  <a href="../../index.html" title="Aller à la page principale">
                    <img alt="Logo" src="../../arcane_framework_small.webp" />
                  </a>
                </td>
              </tr>
              <tr id="projectrow">
                <td id="projectalign">
                  <div id="projectname">Arcane
                    <span id="projectnumber">&#160;v3.13.6.0</span>
                  </div>
                  <div id="projectbrief">Documentation utilisateur</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- end header part -->
<!-- Généré par Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/d41/arcanedoc_services_modules_simplecsvoutput_example4.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Exemple n°4</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table des matières</h3>
<ul><li class="level1"><a href="#autotoc_md160">Point d&#39;entrée initial</a></li>
<li class="level1"><a href="#autotoc_md161">Point d&#39;entrée loop</a></li>
<li class="level1"><a href="#autotoc_md162">Point d&#39;entrée exit</a></li>
</ul>
</div>
<div class="textblock"><p>À partir de cet exemple, il ne sera plus question d'options ou de singleton. Ici, il sera question d'optimisation, dans le cas où ce service est utilisé de manière plus sérieuse que du simple debuggage.</p>
<p>Le résultat va donc changer un peu : </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Results_Example4   </th><th class="markdownTableHeadNone">Iteration 1   </th><th class="markdownTableHeadNone">Iteration 2   </th><th class="markdownTableHeadNone">Iteration 3   </th><th class="markdownTableHeadNone">Somme    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Nb de Fissions   </td><td class="markdownTableBodyNone">36   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">85   </td><td class="markdownTableBodyNone">121    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Nb de Collisions   </td><td class="markdownTableBodyNone">29   </td><td class="markdownTableBodyNone">84   </td><td class="markdownTableBodyNone">21   </td><td class="markdownTableBodyNone">134   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md160"></a>
Point d'entrée initial</h1>
<p>Voyons le point d'entrée <code>start-init</code> :</p>
<p><code>SimpleTableOutputExample4Module.cc</code> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> SimpleTableOutputExample4Module::</div>
<div class="line">initModule()</div>
<div class="line">{</div>
<div class="line">  srand(1234);</div>
<div class="line">  options()-&gt;stOutput()-&gt;init();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Pour cet exemple, on va définir le nom des colonnes dès l&#39;init.</span></div>
<div class="line">  <span class="comment">// En effet, ajouter des colonnes au fur et à mesure prend du temps</span></div>
<div class="line">  <span class="comment">// puisque le tableau est réalloué à chaque fois (dans l&#39;implem actuelle).</span></div>
<div class="line">  <span class="comment">// (après, si les perfs de cette partie ne sont pas une priorité, c&#39;est </span></div>
<div class="line">  <span class="comment">// pas impératif de faire ça, tout dépend de l&#39;utilisation faite du service).</span></div>
<div class="line">  StringUniqueArray columns_name(NB_ITER);</div>
<div class="line">  <span class="keywordflow">for</span>(Integer i = 0; i &lt; NB_ITER; i++){</div>
<div class="line">    columns_name[i] = <span class="stringliteral">&quot;Iteration &quot;</span> + String::fromNumber(i+1);</div>
<div class="line">  }</div>
<div class="line">  options()-&gt;stOutput()-&gt;addColumns(columns_name);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// On ajoute aussi les deux lignes.</span></div>
<div class="line">  <span class="comment">// Toujours dans un soucis d&#39;optimisation, on peut créer les lignes et récupérer</span></div>
<div class="line">  <span class="comment">// leur position pour la suite, ainsi, on évite deux recherches de String dans un</span></div>
<div class="line">  <span class="comment">// tableau de String à chaque itération.</span></div>
<div class="line">  options()-&gt;stOutput()-&gt;addRows(StringUniqueArray{<span class="stringliteral">&quot;Nb de Fissions&quot;</span>, <span class="stringliteral">&quot;Nb de Collisions&quot;</span>});</div>
<div class="line"> </div>
<div class="line">  m_pos_fis = options()-&gt;stOutput()-&gt;rowPosition(<span class="stringliteral">&quot;Nb de Fissions&quot;</span>);</div>
<div class="line">  m_pos_col = options()-&gt;stOutput()-&gt;rowPosition(<span class="stringliteral">&quot;Nb de Collisions&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  options()-&gt;stOutput()-&gt;print();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Dans cet exemple, on va créer les lignes et les colonnes dans l'init au lieu de le faire au fur et à mesure.</p>
<p>De plus, on va récupérer les positions des lignes.</p>
<p>En effet, au niveau interne, le tableau de valeur est représenté simplement par un objet de la classe <a class="el" href="../../d0/d32/namespaceArcane.html#aa7acc561db817c4ba0bf267d8d62fc6d">RealUniqueArray2</a>, un tableau 2D. <br  />
 Niveau algorithmique, ce tableau est représenté par un tableau 1D, chaque ligne est mise côte à côte dans la mémoire. <br  />
 Créer une ligne est donc facile (s'il y a de la place) car il suffit d'agrandir le tableau 1D. <br  />
 Mais ajouter une colonne est sensiblement plus complexe et long car on est obligé de décaler les valeurs de N-1 lignes. Et plus il y a de valeurs dans le tableau, plus ce sera long.</p>
<p>Pour éviter tout cela, on peut créer les lignes et les colonnes dès le début. Après, il suffira d'ajouter les valeurs où il faut.</p>
<p>Pour aller encore plus loin, on sauvegarde les positions des deux lignes dans des attributs de la classe. <br  />
 Ça permet d'éviter d'effectuer une recherche de <code>String</code> dans le tableau interne de nom des lignes <code>StringUniqueArray</code>. <br  />
 Mais c'est quelque chose de dispensable étant donné que moins il y a de lignes moins cette recherche est couteuse et plus il y a de lignes, plus la gestion des positions est compliqué. <br  />
 Pour cette partie, à vous de voir.</p>
<h1><a class="anchor" id="autotoc_md161"></a>
Point d'entrée loop</h1>
<p>Voyons le point d'entrée <code>compute-loop</code> :</p>
<p><code>SimpleTableOutputExample4Module.cc</code> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> SimpleTableOutputExample4Module::</div>
<div class="line">loopModule()</div>
<div class="line">{</div>
<div class="line">  Integer nb_fissions = rand()%99;</div>
<div class="line">  Integer nb_collisions = rand()%99;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// On ajoute deux valeurs à nos deux lignes.</span></div>
<div class="line">  options()-&gt;stOutput()-&gt;addElementInRow(m_pos_fis, nb_fissions);</div>
<div class="line">  options()-&gt;stOutput()-&gt;addElementInRow(m_pos_col, nb_collisions);</div>
<div class="line"> </div>
<div class="line">  options()-&gt;stOutput()-&gt;print();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (m_global_iteration() == NB_ITER)</div>
<div class="line">    subDomain()-&gt;timeLoopMng()-&gt;stopComputeLoop(<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Ici, on peut voir que l'on utilise la méthode <a class="el" href="../../d6/de8/classArcane_1_1ISimpleTableOutput.html#a17cfc5d82aa824e3f452d06460c7edbc">ISimpleTableOutput::addElementInRow()</a> différemment. <br  />
 En effet, cette méthode est surchargée pour permettre l'utilisation de la position de la ligne au lieu de son nom, ce qui permet d'éviter une recherche de String. <br  />
 De plus, cette méthode retourne un booleen qui permet de savoir si la valeur a pu être ajouté ou non, dans le cas où la position est fausse. <br  />
 (Pour simplifier l'exemple, je ne vérifie pas la valeur retournée).</p>
<h1><a class="anchor" id="autotoc_md162"></a>
Point d'entrée exit</h1>
<p>Enfin, voyons le point d'entrée <code>exit</code> :</p>
<p><code>SimpleTableOutputExample4Module.cc</code> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> SimpleTableOutputExample4Module::</div>
<div class="line">endModule()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// On peut faire la somme des valeurs des lignes si on souhaite.</span></div>
<div class="line">  <span class="comment">// Dans le cas où il y a des cases vides, elle sont initialisé à 0.</span></div>
<div class="line">  <span class="keywordflow">for</span>(Integer pos = 0; pos &lt; options()-&gt;stOutput()-&gt;numberOfRows(); pos++) {</div>
<div class="line">    RealUniqueArray row = options()-&gt;stOutput()-&gt;row(pos);</div>
<div class="line">    Real sum = 0.;</div>
<div class="line">    <span class="keywordflow">for</span>(Real elem : row) {</div>
<div class="line">      sum += elem;</div>
<div class="line">    }</div>
<div class="line">    options()-&gt;stOutput()-&gt;addElementInColumn(<span class="stringliteral">&quot;Somme&quot;</span>, sum);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  options()-&gt;stOutput()-&gt;print();</div>
<div class="line">  options()-&gt;stOutput()-&gt;writeFile();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Pour varier un peu et montrer comment utiliser les valeurs entrées dans le tableau, on a fait la somme des deux lignes et on met ces résultats dans une nouvelle colonne <code>Somme</code>.</p>
<dl class="section note"><dt>Note</dt><dd>On n'utilise pas de ArrayView dans le service car c'est impossible de faire une vue sur une colonne étant donné que les valeurs des colonnes sont discontinues.</dd></dl>
<p>Cet exemple de somme permet de voir que ce service n'est pas juste un service d'écriture de fichier mais peut aussi stocker des valeurs pour les exploiter après.</p>
<hr  />
<div class="section_buttons"> <span class="back_section_button"> <a class="el" href="../../dc/da6/arcanedoc_services_modules_simplecsvoutput_example3.html">Exemple n°3</a> </span> <span class="next_section_button"> <a class="el" href="../../dd/def/arcanedoc_services_modules_simplecsvoutput_example5.html">Exemple n°5</a> </span> </div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
  <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="navelem"><a class="el" href="../../index.html">%Arcane</a></li><li class="navelem"><a class="el" href="../../db/dc1/arcanedoc_services_modules.html">Services et modules disponibles</a></li><li class="navelem"><a class="el" href="../../de/dc3/arcanedoc_services_modules_simplecsvoutput.html">Service SimpleCsvOutput</a></li>
      <li class="footer">Généré le Lundi 15 Juillet 2024 02:42:58 pour Arcane par <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
    </ul>
  </div>
  <script type="text/javascript" src="../../script-apply-config-theme.js"></script>
  <script type="text/javascript">
    // On met l'appel à cette fonction dans le footer dans le cas où
    // une page ne veut pas de personnalisation (changement de la 
    // variable globale "no_custom_theme").
    applyConfigWithCookies();
  </script>
</body>
</html>
