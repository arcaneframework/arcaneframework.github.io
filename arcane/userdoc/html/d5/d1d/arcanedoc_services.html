<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arcane: Les services inclus dans Arcane</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arcane
   &#160;<span id="projectnumber">3.7.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Recherche','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d1d/arcanedoc_services.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Les services inclus dans Arcane </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table des matières</h3>
<ul><li class="level1"><a href="#arcanedoc_services_csv">Documentation pour le service SimpleCsvOutput</a><ul><li class="level2"><a href="#autotoc_md31">Utilisation</a><ul><li class="level3"><a href="#autotoc_md32">Singleton</a></li>
<li class="level3"><a href="#autotoc_md33">Service</a></li>
<li class="level3"><a href="#autotoc_md34">Symboles de nom pour l&#39;exécution parallèle (implémentation CSV)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_services"></a></p>
<p>La liste des services inclus dans Arcane est disponible ici : <a class="el" href="../../d9/d1a/axldoc_casemainpage_dox.html">Liste des modules et services du jeu de données</a></p>
<p>La liste des interfaces pour les services est disponible ici : <a class="el" href="../../de/d46/out_interfacemainpage_dox.html">Service interfaces</a></p>
<p>L'introduction pour l'utilisation des services est disponible ici : <a class="el" href="../../d1/deb/arcanedoc_core.html#arcanedoc_service">Les services</a></p>
<p>Une lecture de cette partie pourrait aussi aider : <a class="el" href="../../de/d26/arcanedoc_caseoptions.html">Configuration des options jeu de données (fichier AXL)</a></p>
<p>Pour les singletons : <a class="el" href="../../d7/d98/arcanedoc_codeconfig.html">La configuration du code</a></p>
<h1><a class="anchor" id="arcanedoc_services_csv"></a>
Documentation pour le service SimpleCsvOutput</h1>
<p>Ce service permet de créer un tableau 2D de valeur avec des lignes et des colonnes nommées. Aujourd'hui, le format de fichier en sortie est le format CSV. Ce service peut être utilisé comme service classique à définir dans l'AXL d'un module ou comme singleton pour avoir une instance unique pour tous les modules.</p>
<p>Ce service se veut simple d'utilisation mais permet aussi une utilisation plus avancée.</p>
<p>Exemple de fichier .csv : </p><div class="fragment"><div class="line">Results_Example3;Iteration 1;Iteration 2;Iteration 3;</div>
<div class="line">Nb de Fissions;36;0;85;</div>
<div class="line">Nb de Collisions;29;84;21;</div>
</div><!-- fragment --><p> Sous Excel (ou un autre tableur), on obtient ce tableau : </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Results_Example3   </th><th class="markdownTableHeadNone">Iteration 1   </th><th class="markdownTableHeadNone">Iteration 2   </th><th class="markdownTableHeadNone">Iteration 3    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Nb de Fissions   </td><td class="markdownTableBodyNone">36   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">85    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Nb de Collisions   </td><td class="markdownTableBodyNone">29   </td><td class="markdownTableBodyNone">84   </td><td class="markdownTableBodyNone">21   </td></tr>
</table>
<hr  />
 <h2><a class="anchor" id="autotoc_md31"></a>
Utilisation</h2>
<h3><a class="anchor" id="autotoc_md32"></a>
Singleton</h3>
<p>Pour une utilisation en tant que singleton (même objet pour tous les modules) :</p>
<p>Placer ces lignes dans le .config de votre projet : </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">singleton-services</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">service</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;SimpleCsvOutput&quot;</span> <span class="keyword">need</span>=<span class="stringliteral">&quot;required&quot;</span> /&gt;</div>
<div class="line">&lt;/<span class="keywordtype">singleton-services</span>&gt;</div>
</div><!-- fragment --><p> Et dans votre/vos module(s) : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;arcane/ISimpleTableOutput.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d0/d32/namespaceArcane.html">Arcane</a>;</div>
<div class="line"> </div>
<div class="line">ISimpleTableOutput* table = ServiceBuilder&lt;ISimpleTableOutput&gt;(subDomain()).getSingleton();</div>
<div class="line">table-&gt;init(<span class="stringliteral">&quot;Example_Name&quot;</span>);</div>
<div class="line"><span class="comment">//...</span></div>
<div class="line">table-&gt;writeFile(<span class="stringliteral">&quot;./example/&quot;</span>);</div>
<div class="ttc" id="anamespaceArcane_html"><div class="ttname"><a href="../../d0/d32/namespaceArcane.html">Arcane</a></div><div class="ttdoc">-*- tab-width: 2; indent-tabs-mode: nil; coding: utf-8-with-signature -*-</div><div class="ttdef"><b>Definition:</b> AbstractCaseDocumentVisitor.cc:20</div></div>
</div><!-- fragment --> <hr  />
 <h3><a class="anchor" id="autotoc_md33"></a>
Service</h3>
<p>Pour une utilisation en tant que service (objet different pour chaque module) :</p>
<p>Placer ces lignes dans le .axl de votre module : </p><div class="fragment"><div class="line"><span class="comment">&lt;!-- &lt;options&gt; --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">service-instance</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;simple-table-output&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;Arcane::ISimpleTableOutput&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;<span class="keyword">Service</span> <span class="keyword">implémentant</span> <span class="keyword">ISimpleTableOutput</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">service-instance</span>&gt;</div>
<div class="line"><span class="comment">&lt;!-- &lt;/options&gt; --&gt;</span></div>
</div><!-- fragment --><p> Dans le .arc, vous pouvez configurer les options du services. Par exemple : </p><div class="fragment"><div class="line"><span class="comment">&lt;!-- &lt;mon-module&gt; --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">simple-table-output</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;SimpleCsvOutput&quot;</span>&gt;</div>
<div class="line">    <span class="comment">&lt;!-- Le nom du répertoire à créer/utiliser. --&gt;</span></div>
<div class="line">    &lt;<span class="keywordtype">tableDir</span>&gt;./<span class="keyword">example</span>/&lt;/<span class="keywordtype">tableDir</span>&gt;</div>
<div class="line">    <span class="comment">&lt;!-- Le nom du fichier à créer/écraser. --&gt;</span></div>
<div class="line">    &lt;<span class="keywordtype">tableName</span>&gt;<span class="keyword">Results_Example</span>&lt;/<span class="keywordtype">tableName</span>&gt;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">&lt;!-- Au final, on aura un fichier ayant comme chemin : ./example/Results_Example.csv --&gt;</span></div>
<div class="line">  &lt;/<span class="keywordtype">simple-table-output</span>&gt;</div>
<div class="line"><span class="comment">&lt;!-- &lt;/mon-module&gt; --&gt;</span></div>
</div><!-- fragment --><p> Et dans votre module : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;arcane/ISimpleTableOutput.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d0/d32/namespaceArcane.html">Arcane</a>;</div>
<div class="line"> </div>
<div class="line">options()-&gt;simpleCsvOutput()-&gt;init();</div>
<div class="line"><span class="comment">//...</span></div>
<div class="line">options()-&gt;simpleCsvOutput()-&gt;writeFile();</div>
</div><!-- fragment --><p>Vous pouvez aussi utiliser le service des deux façons en même temps, selon vos besoins.</p>
<p>Pour un exemple plus concret, voir la <a href="https://github.com/arcaneframework/arcane-benchs/">mini-app Quicksilver</a></p>
<hr  />
 <h3><a class="anchor" id="autotoc_md34"></a>
Symboles de nom pour l'exécution parallèle (implémentation CSV)</h3>
<p>Dans le nom du repértoire ou dans le nom du tableau, que ce soit en mode singleton ou en mode service, il est possible d'ajouter des "*symboles*" qui seront remplacés lors de l'exécution.</p>
<p>Les <em>symboles</em> disponibles sont :</p><ul>
<li>**@proc_id@** : Sera remplacé par le rank du processus.</li>
<li>**@num_procs@** : Sera remplacé par le nombre total de processus.</li>
</ul>
<p>Par exemple, si l'on a : </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">tableDir</span>&gt;./<span class="keyword">N_</span>@<span class="keyword">num_procs</span>@/&lt;/<span class="keywordtype">tableDir</span>&gt;</div>
<div class="line">&lt;<span class="keywordtype">tableName</span>&gt;<span class="keyword">Results_P</span>@<span class="keyword">proc_id</span>@&lt;/<span class="keywordtype">tableName</span>&gt;</div>
</div><!-- fragment --><p> Et que l'on lance le programme avec 2 processus (ID = 0 et 1), on va obtenir deux csv ayant comme chemin :</p><ul>
<li>./N_2/Results_P0.csv</li>
<li>./N_2/Results_P1.csv</li>
</ul>
<p>(en séquentiel, on aura ./N_1/Results_P0.csv)</p>
<p>Cela permet, entre autres, de :</p><ul>
<li>créer un tableau par processus et de les nommer facilement,</li>
<li>créer des fichiers .arc "générique" où le nombre de processus n'importe pas,</li>
<li>avoir un nom différent pour chaque tableau, dans le cas où un <em>cat</em> est effectué (rappel : <em>tableName</em> donne le nom du fichier csv mais est aussi placé sur la première case du tableau). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Généré le Lundi 8 Août 2022 03:37:21 pour Arcane par <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
