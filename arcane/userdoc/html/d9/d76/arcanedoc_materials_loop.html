<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.9.8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="../../logo_arcane.svg" type="image/svg+xml">
    <title>Arcane: Boucles sur les entités des matériaux et des milieux</title>
    <link href="../../tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../../jquery.js"></script>
    <script type="text/javascript" src="../../dynsections.js"></script>
    <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
    <link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-custom.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../user_colors.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
    <script type="text/javascript" src="../../script-helper.js"></script>
    <script type="text/javascript" src="../../script-resize.js"></script>
    <script type="text/javascript" src="../../script-num-lines-code.js"></script>
    <script type="text/javascript" src="../../script-config-theme.js"></script>
    <script type="text/javascript" src="../../script-edit-config-theme.js"></script>
    <script type="text/javascript" src="../../script-alternative-theme.js"></script>
    <script type="text/javascript">
      // On demande l'activation de la personnalisation de la page.
      var no_custom_theme = false;
      DoxygenAwesomeDarkModeToggle.title = "Thème clair/sombre";
      DoxygenAwesomeDarkModeToggle.init();
      DoxygenAwesomeFragmentCopyButton.title = "Copier le code dans le presse-papier";
      DoxygenAwesomeFragmentCopyButton.init();
      DoxygenAwesomeParagraphLink.init();
      DoxygenAwesomeInteractiveToc.init();
      DoxygenAwesomeTabs.init()
      waitElemForResizeSideNav();
      setOldSize();
      //waitItemExpandCurrent();
    </script>
  </head>
  <body>
    <!--BEGIN CORNER_GITHUB-->
    <!-- https://tholman.com/github-corners/ -->
    <a href="https://github.com/arcaneframework/framework" class="github-corner" aria-label="Voir les sources sur GitHub">
      <svg width="70" height="70" viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
      </svg>
    </a>
    <!--END CORNER_GITHUB-->
      <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr id="projectrow">
                <td id="projectlogo">
                  <a href="../../index.html" title="Aller à la page principale">
                    <img alt="Logo" src="../../arcane_framework_small.webp" />
                  </a>
                </td>
              </tr>
              <tr id="projectrow">
                <td id="projectalign">
                  <div id="projectname">Arcane
                    <span id="projectnumber">&#160;v3.13.6.0</span>
                  </div>
                  <div id="projectbrief">Documentation utilisateur</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- end header part -->
<!-- Généré par Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/d76/arcanedoc_materials_loop.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Boucles sur les entités des matériaux et des milieux</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table des matières</h3>
<ul><li class="level1"><a href="#arcanedoc_materials_loop_loop">Généralisation des boucles</a><ul><li class="level2"><a href="#arcanedoc_materials_loop_envloop">Boucles sur les milieux</a></li>
<li class="level2"><a href="#arcanedoc_materials_loop_matloop">Boucles sur les matériaux</a></li>
<li class="level2"><a href="#arcanedoc_materials_loop_componentloop">Boucles génériques sur les composants</a></li>
</ul>
</li>
<li class="level1"><a href="#arcanedoc_materials_loop_simdloop">Boucles vectorielles sur les composants</a></li>
</ul>
</div>
<div class="textblock"><p>Cette page décrit la gestion des boucles sur les entités des matériaux et des milieux.</p>
<p>Dans le reste de cette page, on utilise le terme générique <em>composant</em> pour décrire un matériau ou un milieu.</p>
<p>Les entités d'un composant peuvent se répartir en deux parties : les entités pures et les entités impures. Par définition, les entités qui ne sont pas pures sont impures. La notion de pure varie suivant le type du composant :</p><ul>
<li>pour un milieu, une entité est pure s'il n'y a qu'un milieu dans cette entité.</li>
<li>pour un matériau, une entité est pure s'il n'y a qu'un seul matériau <b>ET</b> qu'un seul milieu.</li>
</ul>
<p>Au niveau du rangement mémoire pour une variable donnée, accéder à une entité pure revient à accéder à la valeur globale de cette variable.</p>
<h1><a class="anchor" id="arcanedoc_materials_loop_loop"></a>
Généralisation des boucles</h1>
<p>Depuis la version 2.7.0 de Arcane, La macro générique <a class="el" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a" title="Macro générique pour itérer sur les entités d&#39;un matériau ou d&#39;un milieu.">ENUMERATE_COMPONENTITEM()</a> permet d'itérer sur les entités d'un composant de manière globale ou par partie (pure/impure). Elle peut remplacer les macros <a class="el" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#ad0a44976a632ca375796818664c67977" title="Macro pour itérer sur toutes les mailles d&#39;un composant.">ENUMERATE_COMPONENTCELL()</a>, <a class="el" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#ab9c458f7fd0f80713f8229a6fcb9e3c0" title="Macro pour itérer sur toutes les mailles d&#39;un matériau.">ENUMERATE_MATCELL()</a> et <a class="el" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a568f790f7de72e2144399d55d8c63455" title="Macro pour itérer sur toutes les mailles d&#39;un milieu.">ENUMERATE_ENVCELL()</a>.</p>
<p>Les valeurs suivantes sont disponibles pour l'itération :</p>
<p><a class="el" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a" title="Macro générique pour itérer sur les entités d&#39;un matériau ou d&#39;un milieu.">ENUMERATE_COMPONENTITEM(MatCell,icell,container)</a> avec container de type IMeshMaterial* ou MatCellVector.</p>
<p>Il est possible d'itérer uniquement sur la partie pure ou impure d'un composant.</p>
<dl class="section note"><dt>Note</dt><dd>Actuellement, l'ordre de parcours des boucles par partie pure ou impure n'est pas défini et pourra évoluer par la suite. Cela signifie que s'il y a des dépendances entre les itérations de la boucle le résultat peut varier d'une exécution à l'autre.</dd></dl>
<p>Les exemples suivants montrent les différentes variantes de la macro <a class="el" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a" title="Macro générique pour itérer sur les entités d&#39;un matériau ou d&#39;un milieu.">ENUMERATE_COMPONENTITEM()</a></p>
<h2><a class="anchor" id="arcanedoc_materials_loop_envloop"></a>
Boucles sur les milieux</h2>
<div class="fragment"><div class="line">      CellGroup test_env_group;</div>
<div class="line">      IMeshEnvironment* env = env1;</div>
<div class="line">      EnvCellVector env_vector(test_env_group,env);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles du milieu \a env</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(EnvCell,ienvcell,env){</div>
<div class="line">        EnvCell c = *ienvcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[ienvcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles du milieu \a env_vector</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(EnvCell,ienvcell,env_vector){</div>
<div class="line">        EnvCell c = *ienvcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[ienvcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles pures du milieu \a env</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(EnvPartCell,ienvcell,env-&gt;pureEnvItems()){</div>
<div class="line">        EnvCell c = *ienvcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[ienvcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles pures du milieu \a env</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(EnvPartCell,ienvcell,env,eMatPart::Pure){</div>
<div class="line">        EnvCell c = *ienvcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[ienvcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles impures du milieu \a env</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(EnvPartCell,ienvcell,env-&gt;impureEnvItems()){</div>
<div class="line">        EnvCell c = *ienvcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[ienvcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles impures du milieu \a env</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(EnvPartCell,ienvcell,env,eMatPart::Impure){</div>
<div class="line">        EnvCell c = *ienvcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[ienvcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="ttc" id="acore_2materials_2MatItemEnumerator_8h_html_a589e14233bca28cb7e45d6a54cf9476a"><div class="ttname"><a href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a></div><div class="ttdeci">#define ENUMERATE_COMPONENTITEM(enumerator_class_name, iname,...)</div><div class="ttdoc">Macro générique pour itérer sur les entités d'un matériau ou d'un milieu.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df0/core_2materials_2MatItemEnumerator_8h_source.html#l00554">core/materials/MatItemEnumerator.h:554</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="arcanedoc_materials_loop_matloop"></a>
Boucles sur les matériaux</h2>
<div class="fragment"><div class="line">      CellGroup test_mat_group;</div>
<div class="line">      IMeshMaterial* mat = env1-&gt;materials()[0];</div>
<div class="line">      MatCellVector mat_vector(test_mat_group,mat);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(MatCell,imatcell,mat){</div>
<div class="line">        MatCell c = *imatcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[imatcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles du matériau \a mat_vector</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(MatCell,imatcell,mat_vector){</div>
<div class="line">        MatCell c = *imatcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[imatcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles pures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(MatPartCell,imatcell,mat-&gt;pureMatItems()){</div>
<div class="line">        MatCell c = *imatcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[imatcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles pures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(MatPartCell,imatcell,mat,eMatPart::Pure){</div>
<div class="line">        MatCell c = *imatcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[imatcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles impures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(MatPartCell,imatcell,mat-&gt;impureMatItems()){</div>
<div class="line">        MatCell c = *imatcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[imatcell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle sur les mailles impures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(MatPartCell,imatcell,mat,eMatPart::Impure){</div>
<div class="line">        MatCell c = *imatcell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[imatcell];</div>
<div class="line">      }</div>
</div><!-- fragment --><h2><a class="anchor" id="arcanedoc_materials_loop_componentloop"></a>
Boucles génériques sur les composants</h2>
<div class="fragment"><div class="line">      <span class="comment">// Boucle générique sur les mailles du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(ComponentCell,iccell,mat){</div>
<div class="line">        ComponentCell c = *iccell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[iccell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle générique sur les mailles du matériau \a mat_vector</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(ComponentCell,iccell,mat_vector){</div>
<div class="line">        ComponentCell c = *iccell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[iccell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle générique sur les mailles pures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(ComponentPartCell,iccell,mat-&gt;pureItems()){</div>
<div class="line">        ComponentCell c = *iccell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[iccell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle générique sur les mailles pures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(ComponentPartCell,iccell,mat,eMatPart::Pure){</div>
<div class="line">        ComponentCell c = *iccell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[iccell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle générique sur les mailles impures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(ComponentPartCell,iccell,mat-&gt;impureItems()){</div>
<div class="line">        ComponentCell c = *iccell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[iccell];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boucle générique sur les mailles impures du matériau \a mat</span></div>
<div class="line">      <a class="code hl_define" href="../../dd/df0/core_2materials_2MatItemEnumerator_8h.html#a589e14233bca28cb7e45d6a54cf9476a">ENUMERATE_COMPONENTITEM</a>(ComponentPartCell,iccell,mat,eMatPart::Impure){</div>
<div class="line">        ComponentCell c = *iccell;</div>
<div class="line">        mat_pressure[c] = mat_temperature[iccell];</div>
<div class="line">      }</div>
</div><!-- fragment --><h1><a class="anchor" id="arcanedoc_materials_loop_simdloop"></a>
Boucles vectorielles sur les composants</h1>
<dl class="section note"><dt>Note</dt><dd>Dans la version actuelle de Arcane (2.7.0), les boucles vectorielles ne sont supportées que sur les milieux (mais pas encore sur les matériaux).</dd></dl>
<p>Pour pouvoir utiliser la vectorisation sur les composants, il faut inclure le fichier suivant :</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d2/db6/ComponentSimd_8h.html">arcane/materials/ComponentSimd.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d4/d60/namespaceArcane_1_1Materials.html">Arcane::Materials</a>;</div>
<div class="ttc" id="aComponentSimd_8h_html"><div class="ttname"><a href="../../d2/db6/ComponentSimd_8h.html">ComponentSimd.h</a></div></div>
<div class="ttc" id="anamespaceArcane_1_1Materials_html"><div class="ttname"><a href="../../d4/d60/namespaceArcane_1_1Materials.html">Arcane::Materials</a></div><div class="ttdoc">Active toujours les traces dans les parties Arcane concernant les matériaux.</div><div class="ttdef"><b>Definition</b> <a href="../../de/de8/ItemCompatibility_8h_source.html#l00026">ItemCompatibility.h:27</a></div></div>
</div><!-- fragment --><p>Il est nécessaire d'utiliser le mécanisme des lambda du C++11 pour itérer sur les composants via des itérateurs vectoriels. Cela se fait via la macro suivante :</p>
<div class="fragment"><div class="line"><a class="code hl_define" href="../../d2/db6/ComponentSimd_8h.html#a7e1950a58fb735ae92c9993a77f7123f">ENUMERATE_COMPONENTITEM_LAMBDA</a>(){</div>
<div class="line">};</div>
<div class="ttc" id="aComponentSimd_8h_html_a7e1950a58fb735ae92c9993a77f7123f"><div class="ttname"><a href="../../d2/db6/ComponentSimd_8h.html#a7e1950a58fb735ae92c9993a77f7123f">ENUMERATE_COMPONENTITEM_LAMBDA</a></div><div class="ttdeci">#define ENUMERATE_COMPONENTITEM_LAMBDA(iter_type, iter, container)</div><div class="ttdoc">Macro pour itérer sur les entités d'un composant via une fonction lambda du C++11.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db6/ComponentSimd_8h_source.html#l00179">ComponentSimd.h:179</a></div></div>
</div><!-- fragment --><dl class="section warning"><dt>Avertissement</dt><dd>Il ne faut surtout pas oublier le point virgule ';' final. Pour plus d'informations, se reporter à la documentation de cette macro.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Ce mécanisme est expérimental et pourra évoluer par la suite.</dd></dl>
<p>Par exemple, avec les déclarations suivantes des variables :</p>
<div class="fragment"><div class="line">      MaterialVariableCellReal mat_pressure(VariableBuildInfo(mesh,<span class="stringliteral">&quot;Pressure&quot;</span>));</div>
<div class="line">      MaterialVariableCellReal mat_volume(VariableBuildInfo(mesh,<span class="stringliteral">&quot;Volume&quot;</span>));</div>
<div class="line">      MaterialVariableCellReal mat_temperature(VariableBuildInfo(mesh,<span class="stringliteral">&quot;Temperature&quot;</span>));</div>
</div><!-- fragment --><p>Il est possible d'utiliser les boucles vectorielles comme suit :</p>
<div class="fragment"><div class="line">      Real nr = 1.0;</div>
<div class="line">      <span class="comment">// Température et volume en lecture seule</span></div>
<div class="line">      <span class="keyword">auto</span> in_volume = viewIn(mat_volume);</div>
<div class="line">      <span class="keyword">auto</span> in_temperature = viewIn(mat_temperature);</div>
<div class="line">      <span class="comment">// Pression en écriture</span></div>
<div class="line">      <span class="keyword">auto</span> out_pressure = viewOut(mat_pressure);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="../../d2/db6/ComponentSimd_8h.html#a7e1950a58fb735ae92c9993a77f7123f">ENUMERATE_COMPONENTITEM_LAMBDA</a>(EnvPartSimdCell,scell,env){</div>
<div class="line">        out_pressure[scell] = nr * in_temperature[scell] / in_volume[scell];</div>
<div class="line">      };</div>
</div><!-- fragment --><dl class="section warning"><dt>Avertissement</dt><dd>Pour des raisons de performance, l'ordre des itérations peut être quelconque. Il est donc indispensable qu'il n'y ait pas de relations entre les itérations. En particulier, si des opérations non associatives telles que des sommes sur des réels sont utilisées, alors le résultat peut varier entre deux exécutions.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>L'implémentation actuelle comporte plusieurs limitations :<ul>
<li>Il n'est pas encore possible d'utiliser ces énumérateurs avec les boucles concurrentes (voir page <a class="el" href="../../de/d9b/arcanedoc_materials_manage.html#arcanedoc_materials_manage_concurrency">Parallélisation des boucles sur les matériaux et milieux</a>).</li>
<li>Pour le SIMD, il faut obligatoirement utiliser les vues.</li>
<li>Pour l'instant les vues ne sont disponibles que pour les variables scalaires. */</li>
</ul>
</dd></dl>
<hr  />
<div class="section_buttons"> <span class="back_section_button"> <a class="el" href="../../de/d9b/arcanedoc_materials_manage.html">Gestion des matériaux et des milieux.</a> </span></div><div class="section_buttons"></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
  <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="navelem"><a class="el" href="../../index.html">%Arcane</a></li><li class="navelem"><a class="el" href="../../d8/d69/arcanedoc_materials.html">Matériaux et milieux</a></li>
      <li class="footer">Généré le Lundi 15 Juillet 2024 02:42:58 pour Arcane par <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
    </ul>
  </div>
  <script type="text/javascript" src="../../script-apply-config-theme.js"></script>
  <script type="text/javascript">
    // On met l'appel à cette fonction dans le footer dans le cas où
    // une page ne veut pas de personnalisation (changement de la 
    // variable globale "no_custom_theme").
    applyConfigWithCookies();
  </script>
</body>
</html>
