<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arcane: Comparaison bit à bit</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arcane
   &#160;<span id="projectnumber">3.0.4.16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Recherche','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/d0c/arcanedoc_compare_bittobit.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Comparaison bit à bit </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table des matières</h3>
<ul><li class="level1"><a href="#arcanedoc_compare_bittobit_two_exec">Comparaison bit à bit entre deux exécutions</a><ul><li class="level2"><a href="#arcanedoc_compare_bittobit_exec">Exécution de la référence</a></li>
<li class="level2"><a href="#arcanedoc_compare_bittobit_compare">Comparaison avec la référence</a></li>
</ul>
</li>
<li class="level1"><a href="#arcanedoc_compare_verification">Vérification des comparaisons</a><ul><li class="level2"><a href="#arcanedoc_compare_synchronization">Vérification des synchronisations</a></li>
<li class="level2"><a href="#arcanedoc_compare_replica">Vérification des valeurs entre replica</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__home_grospellierg_arcane_packaging_framework_arcane_doc_common_compare_bittobit"></a></p>
<p>Cette page décrit les outils disponibles dans ARCANE pour effectuer des comparaisons bit à bit des valeurs des variables gérées par ARCANE. Les comparaisons suivantes sont possibles:</p><ul>
<li><a class="el" href="../../d8/d0c/arcanedoc_compare_bittobit.html#arcanedoc_compare_bittobit_two_exec">Comparaison bit à bit entre deux exécutions</a></li>
<li><a class="el" href="../../d8/d0c/arcanedoc_compare_bittobit.html#arcanedoc_compare_synchronization">Vérification des synchronisations</a></li>
<li><a class="el" href="../../d8/d0c/arcanedoc_compare_bittobit.html#arcanedoc_compare_replica">Vérification des valeurs entre replica</a></li>
</ul>
<p>Il est important de noter que la comparaison n'est possible que sur les variables gérées par Arcane (comme #VariableCellReal, #VariableScalarInt32, ...). Dans l'implémentation actuelle, seules les variables ayant un type de donnée numérique sont comparées (donc par exemple par les types de données 'String').</p>
<h1><a class="anchor" id="arcanedoc_compare_bittobit_two_exec"></a>
Comparaison bit à bit entre deux exécutions</h1>
<p>Ce mécanisme permet de déterminer la liste des variables Arcane qui sont différentes entre deux exécutions. Il ne fonctionne que sur les variables Arcane.</p>
<p>Le principe de fonctionnement est le suivant:</p><ul>
<li>Exécution d'un cas de référence, avec sauvegarde des résultats.</li>
<li>Exécution d'un deuxième cas et comparaison pendant l'exécution avec le cas de référence.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Comme il faut d'abord exécuter un cas de référence et sauver les résultats sur disque, les données sauvegardées peuvent être très volumineuses suivant les cas.</dd>
<dd>
avant la version 1.22.2 de Arcane, seules les variables sur les entités du maillage étaient comparées. Depuis cette version, les variables tableaux qui ne reposent pas sur une entité du maillage sont aussi comparées.</dd></dl>
<p>Toutes les variables Arcane sont comparées sauf celles qui ont la propriété IVariable::PExecutionDepend à vrai. En comparaison parallèle/sequentiel, celles qui ont aussi la propriété IVariable::PSubDomainDepend ne sont pas comparées.</p>
<h2><a class="anchor" id="arcanedoc_compare_bittobit_exec"></a>
Exécution de la référence</h2>
<p>Pour sauvegarder les informations de référence, il suffit de lancer le cas après avoir positionné la variable d'environnement <b>STDENV_VERIF</b> à la valeur <b>WRITE</b>. Dans ce cas, les valeurs de toutes les variables seront sauvées à chaque itération. Il est possible de le faire pour chaque point d'entrée en positionnant la variable d'environnement <b>STDENV_VERIF_ENTRYPOINT</b> mais cela augmente beaucoup le volume des informations à sauver.</p>
<p>Par défaut, les informations sont sauvées dans le répertoire <code>/tmp/$USER/verif</code> mais il est possible de changer cela en spécifiant un autre chemin dans la variable d'environnement <b>STDENV_VERIF_PATH</b></p>
<dl class="section note"><dt>Note</dt><dd>Dans le cas d'une comparaison pour un cas parallèle, il faut être certain que le chemin utilisé pour les données soit accessible de l'ensemble des noeuds du calculateur, ce qui n'est généralement pas le cas du répertoire <code>/tmp</code>.</dd></dl>
<h2><a class="anchor" id="arcanedoc_compare_bittobit_compare"></a>
Comparaison avec la référence</h2>
<p>Une fois la référence exécutée, il suffit de positionner la variable d'environnement <b>STDENV_VERIF</b> à <b>READ</b> et de lancer une nouvelle exécution. Il est possible de changer le nombre de sous-domaines par rapport à l'exécution de référence et ainsi faire des comparaisons entre parallèle et séquentiel (dans ce cas, l'exécution séquentielle doit être celle de référence et être exécutée en premier) ou des comparaisons parallèles/parallèles.</p>
<p>Dans le listing de l'exécution, apparait alors pour chaque itération (ou pour chaque point d'entrée si <b>STDENV_VERIF_ENTRYPOINT</b> est définie) la liste des variables qui sont différentes entre cette exécution et la référence, ainsi que leurs valeurs, comme suit:</p>
<pre class="fragment">*I-TimeLoopMng Processor 3 : 50 entité(s) ayant des valeurs différentes pour la variable CaracteristicLength:
50 entité(s) ayant des valeurs différentes pour la variable CaracteristicLength
VDIFF: Variable 'CaracteristicLength' (G) uid=1264 lid=673 val: 0.00495968464432893 réf: 0.00495967741935477 rdiff: -1.45674275618805e-06
VDIFF: Variable 'CaracteristicLength' (G) uid=1263 lid=672 val: 0.00495968464432893 réf: 0.00495967741935477 rdiff: -1.45674275618805e-06
VDIFF: Variable 'CaracteristicLength' (G) uid=1250 lid=659 val: 0.00495968464432892 réf: 0.00495967741935477 rdiff: -1.45674275601317e-06
VDIFF: Variable 'CaracteristicLength' (G) uid=1272 lid=681 val: 0.00495968464432892 réf: 0.00495967741935477 rdiff: -1.45674275601317e-06
VDIFF: Variable 'CaracteristicLength' (G) uid=1251 lid=660 val: 0.00495968464432892 réf: 0.00495967741935477 rdiff: -1.45674275601317e-06
VDIFF: Variable 'CaracteristicLength' (G) uid=1252 lid=661 val: 0.00495968464432892 réf: 0.00495967741935477 rdiff: -1.45674275601317e-06
VDIFF: Variable 'CaracteristicLength' (O) uid=1264 lid=39 val: 0.00495968464432893 réf: 0.00495967741935477 rdiff: -1.45674275618805e-06
VDIFF: Variable 'CaracteristicLength' (O) uid=1263 lid=38 val: 0.00495968464432893 réf: 0.00495967741935477 rdiff: -1.45674275618805e-06
VDIFF: Variable 'CaracteristicLength' (O) uid=1250 lid=25 val: 0.00495968464432892 réf: 0.00495967741935477 rdiff: -1.45674275601317e-06
VDIFF: Variable 'CaracteristicLength' (O) uid=1272 lid=47 val: 0.00495968464432892 réf: 0.00495967741935477 rdiff: -1.45674275601317e-06
</pre><p>Pour chaque variable et chaque sous-domaine est indiqué son nom, le Item::uniqueId() et le Item::localId() de l'entité ainsi que si elle est fantôme ((G)) ou appartenant au sous-domaine ((O)) , la valeur actuelle (val), la valeur de référence (ref) et la différence relative (rdiff). Pour ne pas alourdir le listing, seules les 10 différences les plus importantes en valeur absolue sont affichées.</p>
<p>Lorsque la variable est une variable tableau et n'est pas sur une entité du maillage, le (G) ou (O) n'apparait pas et au lieu du numéro local de l'entité, c'est l'indice de l'élément dans le tableau qui est affiché.</p>
<p>En parallèle, il peut être normal que les valeurs sur les mailles fantômes soient différentes de la référence si la variable n'est pas synchronisée. Comme cela peut-être le cas pour de nombreuses variables, il est possible de n'afficher les différences que sur les mailles appartenant au sous-domaine, en positionnant la variable d'environnement <b>STDENV_VERIF_SKIP_GHOSTS</b>.</p>
<h1><a class="anchor" id="arcanedoc_compare_verification"></a>
Vérification des comparaisons</h1>
<h2><a class="anchor" id="arcanedoc_compare_synchronization"></a>
Vérification des synchronisations</h2>
<p>De la même manière qu'il est possible de faire des comparaisons bit à bit, il est possible de vérifier que les variables sont bien synchronisées entre les sous-domaines. Pour cela, il suffit de spécifier la valeur <b>CHECKSYNC</b> à la variable d'environnement <b>STDENV_VERIF</b>. Les valeurs avec l'attribut <em>IVariable::PNoNeedSync</em> et les variables partielles ne sont pas comparées.</p>
<h2><a class="anchor" id="arcanedoc_compare_replica"></a>
Vérification des valeurs entre replica</h2>
<p>Il est aussi possible de vérifier que les valeurs d'une variable sont les mêmes sur tous les replica d'un sous-domaine. Pour cela, il faut spécifier la valeur <b>CHECKREPLICA</b> à la variable d'environnement <b>STDENV_VERIF</b>. Les variables avec l'attribut <em>IVariable::PNoReplicaSync</em> et les variables partielles ne sont pas comparées. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">%Arcane</a></li>
    <li class="footer">Généré le Jeudi 23 Septembre 2021 09:25:20 pour Arcane par <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
